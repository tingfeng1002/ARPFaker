1. ARP地址解析协议
   ARP协议（Address Resolution Protocol）是一个地址解析协议，主要功能为通过目标主机的IP地址，查询目标主机的MAC地址</br>
   每台安装有TCP/IP协议的电脑里都有一个ARP缓存表，这个表里的IP地址与MAC地址是一一对应的。

2. 为什么有了IP地址还需要mac地址
   因为在网络中主机和主机之间通信数据包需要依据OSI模型从上往下进行数据封装，当数据封装完成后再向下层发出，需要将ip地址和mac地址的封装</br>
   一般情况下，对于上层应用程序来说更多的是关心ip地址而不是MAC地址，而对于底层网络链路数据通信来说使用的是MAC地址。 </br>
  也就是说，不管网络层使用的是什么协议，在实际网络的链路上传送数据帧时，最终还是必须使用mac地址（硬件地址），所以需要ARP协议来获取目的主机的mac地址来完成数据的封装和转发。

3. ARP 告诉缓存 
   每一个主机都设有一个 ARP 高速缓存(ARP cache)，里面有所在的局域网上的各主机和路由器的 IP 地址到mac地址的映射表。 </br>
   当主机A向局域网主机B 发送数据报时,现在缓存中查找主机B的信息,有则查出来mac,再将mac 地址写入协议报文中

4. ARP工作原理
   假如在同一局域网下，主机A的IP地址为209.0.0.5，主机A的mac地址为00-00-C0-15-AD-18，主机B的IP地址为209.0.0.6，主机B的mac地址暂时不知道。
   同一局域网下，实际是使用mac地址来进行确定唯一一台主机，如果主机A要给主机B通信，比如：主机A要给主机B发送一个hello数据，现在只知道主机B的IP地址，而IP地址是工作在网络层的，但是数据在网络层往下传输到链路层使用的是mac地址，但问题是现在我们并不知道主机B的mac地址，具体流程如下：
   - 当发送数据时，主机A会在自己的ARP缓存表中寻找是否有目标IP地址，如果找到就知道目标MAC地址为（00-BB-00-62-C2-02），直接把目标MAC地址写入帧里面发送就可。如果在ARP缓存表中没有找到相对应的IP地址，主机A就会在网络上发送一个广播（ARP request），目标MAC地址是“FF.FF.FF.FF.FF.FF”，这表示向同一网段内的所有主机发出这样的询问：“192.168.38.11的MAC地址是多少？”
   - 其他主机收到广播请求后，会把主机A请求的IP地址209.0.0.6和自己的IP地址对应，如果不对直接把这个广播（ARP request）请求丢弃掉，不会回应主机A，当主机B收到请求后，拿到IP地址和自己对应上了，就会发送一个ARP响应信息，把主机B的IP地址和mac地址告诉主机A，注意：主机B响应的时候是以单播的形式响应的，而主机A是以广播的形式发送的。

5. ARP在以太网中的封装格式
   转包工具中一般都有报文与协议显示，报文内容大致如下：
   who has 192.168.22.77 ? Tell 192.168.22.1 表示请求IP地址为192.168.22.77的主机的mac地址，把你的mac地址告诉IP地址为 192.168.22.1的主机
   Broadcast就是广播的意思。
   - ARP 报文封装
     Address Resolution Protocol (request)   //request表示ARP请求,reply表示ARP响应
     Hardware type: Ethernet (1)       //硬件类型是以太网，（0x0001表示的是以太网的标号）
     Protocol type: IPv4 (0x0800)         //协议类型是IPv4（0x0800表示的是IPv4的标号）
     Hardware size: 6                //硬件地址长度，其实说的就是mac地址的字节长度，一般是6字节
     Protocol size: 4               //协议地址长度，其实说的就是ip地址的字节长度，一般是4字节
     Opcode: request (1)          //表示操作码：1为ARP请求，2为ARP应答，3为RARP请求，4为RARP应答。
     Sender MAC address: Tp-LinkT_b3:97:14 (3c:46:d8:b3:97:14)    //源mac地址，一般为发送方的mac地址。
     Sender IP address: 192.168.22.4                         //源IP地址，一般为发送方的ip地址
     Target MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)   //目标mac地址，一般为接收方的mac地址，由于这里是ARP请求，所以mac地址以0填充
     Target IP address: 192.168.22.1                        //目标ip地址，一把为接收方的ip地址

6. 抓包工具字段说明
   目标以太网地址（Destination）：即目标MAC地址，ff:ff:ff:ff:ff:ff（二进制全1）为广播地址。
   源以太网地址（Source）：发送方MAC地址
   帧类型(Type)：以太类型，也就是说在二层数据帧是以ARP协议进行封装的，0x0806则表示ARP协议。
   填充选项（Padding）：一般以0填充

   
7. ARP缓存表
   windows下可以使用arp -a命令查看arp缓存表中的信息：
   arp –d清除本机arp缓存表
   arp –a查看本机当前arp表
   arp –s绑定arp地址（注意：本次机器生效，下次重启后会全部失效）

10. 代理ARP协议（Proxy ARP）
    代理ARP（Proxy-arp）的原理就是当出现跨网段的ARP请求时，路由器将自己的MAC返回给发送ARP广播请求发送者，实现MAC地址代理（善意的欺骗），最终使得主机能够通信。

